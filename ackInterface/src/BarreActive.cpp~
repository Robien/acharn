#include "BarreActive.h"

using namespace std;

BarreActive::BarreActive(InterfaceInfo* inter,
                Skin* skin,
                irr::core::position2d<irr::s32> coord,
                int larg, int haut,
                string fond, string motif,
                int max, int val,
                irr::gui::IGUIWindow* parent) {

	// création de la barre de fond insenssible
	barreFond = new Bouton(inter->getGui(),
	                           inter->getPilote(),
	                           irr::core::rect<irr::s32>(coord.X,
	                                                     coord.Y,
	                                                     coord.X+larg,
	                                                     coord.Y+haut),
	                           true,
	                           false,
							   skin->getSkinTexture(fond),
	                           parent,
	                           L"");
	barreFond->getBouton()->setIsPushButton(false);

	// création de la barre active
	barreMotif = new Bouton(inter.getGui(),
	                           inter.getPilote(),
	                           irr::core::rect<irr::s32>(coord.X,
	                                                     coord.Y,
	                                                     coord.X+larg,
	                                                     coord.Y+haut),
	                           true,
	                           false,
							   skin->getSkinTexture(motif),
	                           parent,
	                           L"");
	barreMotif->getBouton()->setIsPushButton(false);

	//initialisation
	coordonee=coord;
	maximum=max;
	largeur=larg;
	hauteur=haut;
	setVal(val);
}

void BarreActive::setVal(int val){
	valeur=val;
	//redimenssionement de la barre active
    barreMotif->getBouton()->setRelativePosition(irr::core::rect<irr::s32 > (coordonee.X,
                                                                      coordonee.Y,
                                                                      coordonee.X+inPercentOfMax(val),
                                                                      coordonee.Y+hauteur));
}

irr::s32 BarreActive::inPercentOfMax(int val){
	//calcul du ration val/max pour obtenir la nouvelle largeur de la barre
    irr::s32 ratio = (irr::s32)((signed int) ((((float) val) / ((float) maximum))*largeur));
	return ratio;
}
